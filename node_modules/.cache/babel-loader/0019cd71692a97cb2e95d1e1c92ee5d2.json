{"ast":null,"code":"var _jsxFileName = \"/Users/we/dev/cp-dev/src/page/main/MainContainer.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport axios from 'axios';\nimport PAGECONST from './utils/Constants';\nimport Card from '../../components/molecules/layout/card/Card';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction MainContainer({}) {\n  _s();\n\n  const [paging, setPaging] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [list, setList] = useState([]);\n  const [payload, setPayload] = useState({\n    params: {\n      page: 1,\n      pageCount: PAGECONST.count,\n      totalCount: 0\n    }\n  });\n  /* 타겟 엘리먼트 */\n\n  const rootRef = useRef(null);\n  const targetRef = useRef(null);\n\n  const getData = () => {\n    let key = '80CFeBE4MD6JmhEfClBx7zqo1eGvwTl5EZgKyMQc';\n    axios.get(\"http://52.78.173.151/boards\", {\n      \"x-api-key\": key,\n      params: {\n        page: payload.params.page,\n        count: payload.params.pageCount\n      }\n    }).then(response => {\n      if (response) {\n        const {\n          result,\n          data\n        } = response.data;\n\n        if (result.code === 1) {\n          setIsLoading(true);\n          const paging = response.data.paging;\n          const newList = response.data.data;\n          const updateList = list.concat(newList);\n          setList(updateList);\n          setPaging(paging);\n          setIsLoading(false);\n        }\n      }\n    }).catch(err => alert(\"글을 가져오는데 실패 했습니다.\"));\n  };\n\n  const handlerNaxtBtn = () => {\n    console.log('TEST');\n    const {\n      page\n    } = payload.params;\n\n    if (Math.ceil(paging.totalCount / paging.count) > payload.params.page) {\n      setPayload({\n        params: { ...payload.params,\n          page: page + 1\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    getData();\n  }, [payload]);\n  useEffect(() => {// console.log('list # ',list)\n    // console.log('paging # ',paging)\n    // console.log('payload # ',payload)\n  }, [list, paging]); // options 설정\n\n  const options = {\n    root: document.querySelector('.container'),\n    // .container class를 가진 엘리먼트를 root로 설정. null일 경우 브라우저 viewport\n    rootMargin: '10px',\n    // rootMargin을 '10px 10px 10px 10px'로 설정\n    threshold: [0, 0.5, 1] // 타겟 엘리먼트가 교차영역에 진입했을 때, 교차영역에 타켓 엘리먼트의 50%가 있을 때, 교차 영역에 타켓 엘리먼트의 100%가 있을 때 observe가 반응한다.\n\n  }; // IntersectionObserver 생성\n\n  const io = new IntersectionObserver((entries, observer) => {\n    // IntersectionObserverEntry 객체 리스트와 observer 본인(self)를 받음\n    // 동작을 원하는 것 작성\n    entries.forEach(entry => {\n      // entry와 observer 출력\n      console.log('entry:', entry);\n      console.log('observer:', observer);\n    });\n  }, options); // /* 인터섹션 callback */\n  // const onIntersect = async ([entry], observer) => {\n  //   if (entry.isIntersecting) {\n  //     observer.unobserve(entry.targetRef);\n  //     await getData();\n  //     observer.observe(entry.targetRef);\n  //   }\n  // };\n  // useEffect(() => {\n  //   let observer;\n  //   if (targetRef) {\n  //     observer = new IntersectionObserver(onIntersect, { threshold: 0.5 });\n  //     observer.observe(targetRef);\n  //   }\n  //   return () => observer && observer.disconnect();\n  // }, [targetRef]);\n  //   let observer;\n  //   let options = {\n  //     root: null,\n  //     rootMargin: '10px',\n  //     threshold: 0.1\n  //   }\n  //   overserver = new IntersectionObserver(handleIntersect, options)\n  //   observer.observe(boxElement);\n  //   function handleIntersect(entries, observer) {\n  //     entries.forEach((entry) => {\n  //       //DOM = entry.target으로 지정하면 해당 요소 관찰\n  //       if (entry.intersectionRatio > prevRatio) {\n  //         entry.target.style.backgroundColor = increasingColor.replace(\"ratio\", entry.intersectionRatio);\n  //       } else {\n  //         entry.target.style.backgroundColor = decreasingColor.replace(\"ratio\", entry.intersectionRatio);\n  //       }\n  //       prevRatio = entry.intersectionRatio;\n  //     });\n  //   }\n  //   observerHandler = (entries, observer) => {\n  //     entries.forEach((entry) => {\n  //       console.log(this);\n  //       if (entry.isIntersecting) {\n  //         console.log(\"print\");\n  //         const image = entry.target;\n  //         const src = image.dataset.src; // img 태그의 data-lazy에 저장해둔 이미지 경로를 붙여준다.\n  //         image.setAttribute(\"src\", src);\n  //         image.removeAttribute(\"data-src\");\n  //         observer.unobserve(entry.target);\n  //       }\n  //     }, {\n  //       rootMargin: '1px 1px 1px 1px',\n  //       thresholds: [0.7],\n  //     });\n  //   }\n  // lazyLoadHandler= () => {\n  //     this.lazyImages = Array.prototype.slice.call(\n  //       // document.body.querySelectorAll(\".image\")\n  //     );\n  //     this.intersectionObserver = new IntersectionObserver(this.observerHandler.bind(this), this.options);\n  //     this.lazyImages.forEach((item) => this.intersectionObserver.observe(item));\n  //   }\n  // ref={rootRef}\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [list.map((el, i) => {\n      return (\n        /*#__PURE__*/\n        // <Card className=\"box\" key={i} ref={i == list.length - 1 && !payload.params.totalCount ? targetRef : null} ListData={list} item={el}/>\n        _jsxDEV(Card, {\n          className: \"box\",\n          ListData: list,\n          item: el\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 13\n        }, this)\n      );\n    }), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: handlerNaxtBtn,\n      children: \"PUSH!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: targetRef,\n      className: \"spinner\",\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 161,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MainContainer, \"HjR8pfwHIX/fcmDAq52ZZau3MSA=\");\n\n_c = MainContainer;\nexport default MainContainer;\n\nvar _c;\n\n$RefreshReg$(_c, \"MainContainer\");","map":{"version":3,"sources":["/Users/we/dev/cp-dev/src/page/main/MainContainer.js"],"names":["React","useState","useEffect","useCallback","useRef","axios","PAGECONST","Card","MainContainer","paging","setPaging","isLoading","setIsLoading","list","setList","payload","setPayload","params","page","pageCount","count","totalCount","rootRef","targetRef","getData","key","get","then","response","result","data","code","newList","updateList","concat","catch","err","alert","handlerNaxtBtn","console","log","Math","ceil","options","root","document","querySelector","rootMargin","threshold","io","IntersectionObserver","entries","observer","forEach","entry","map","el","i"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useCallback, useRef} from 'react'\nimport axios from 'axios'\nimport PAGECONST from './utils/Constants';\nimport Card from '../../components/molecules/layout/card/Card'\n\nfunction MainContainer({}) { \n    const [paging, setPaging] = useState({})\n    const [isLoading, setIsLoading] = useState(false)\n    const [list, setList] = useState([])\n    const [payload, setPayload] = useState({\n        params: {\n            page: 1,\n            pageCount: PAGECONST.count,\n            totalCount: 0\n        }\n    })\n    /* 타겟 엘리먼트 */\n    const rootRef = useRef(null);\n    const targetRef = useRef(null);\n\n    const getData = () => {\n      let key = '80CFeBE4MD6JmhEfClBx7zqo1eGvwTl5EZgKyMQc'\n      axios.get(\"http://52.78.173.151/boards\", {\n        \"x-api-key\": key,\n        params:{\n          page: payload.params.page,\n          count: payload.params.pageCount\n        }\n        })\n        .then( response => {\n         if(response){\n           const { result, data } = response.data\n           if(result.code === 1){\n              setIsLoading(true)\n              const paging = response.data.paging;\n              const newList = response.data.data;\n              const updateList = list.concat(newList);\n              setList(updateList);\n              setPaging(paging)\n              setIsLoading(false)\n           }\n         }\n        })\n        .catch(err => alert(\"글을 가져오는데 실패 했습니다.\"))\n    }\n    \n\n  const handlerNaxtBtn = () =>{\n    console.log('TEST')\n    const { page } = payload.params;\n    if(Math.ceil(paging.totalCount / paging.count) > payload.params.page){\n      setPayload({\n        params: {\n          ...payload.params,\n          page: page + 1,\n        }\n      })\n    }\n  }\n\n  \n\n  useEffect(() => {\n      getData();\n  },[payload])\n  useEffect(() =>{\n    // console.log('list # ',list)\n    // console.log('paging # ',paging)\n    // console.log('payload # ',payload)\n  },[list, paging])\n\n\n\n// options 설정\nconst options = {\n  root: document.querySelector('.container'), // .container class를 가진 엘리먼트를 root로 설정. null일 경우 브라우저 viewport\n  rootMargin: '10px', // rootMargin을 '10px 10px 10px 10px'로 설정\n  threshold: [0, 0.5, 1] // 타겟 엘리먼트가 교차영역에 진입했을 때, 교차영역에 타켓 엘리먼트의 50%가 있을 때, 교차 영역에 타켓 엘리먼트의 100%가 있을 때 observe가 반응한다.\n}\n\n// IntersectionObserver 생성\nconst io = new IntersectionObserver((entries, observer) => {\n  // IntersectionObserverEntry 객체 리스트와 observer 본인(self)를 받음\n  // 동작을 원하는 것 작성\n  entries.forEach(entry => {\n    // entry와 observer 출력\n    console.log('entry:', entry);\n    console.log('observer:', observer);\n  })\n}, options)\n\n\n  // /* 인터섹션 callback */\n  // const onIntersect = async ([entry], observer) => {\n  //   if (entry.isIntersecting) {\n  //     observer.unobserve(entry.targetRef);\n  //     await getData();\n  //     observer.observe(entry.targetRef);\n  //   }\n  // };\n  // useEffect(() => {\n  //   let observer;\n  //   if (targetRef) {\n  //     observer = new IntersectionObserver(onIntersect, { threshold: 0.5 });\n  //     observer.observe(targetRef);\n  //   }\n  //   return () => observer && observer.disconnect();\n  // }, [targetRef]);\n\n  //   let observer;\n  //   let options = {\n  //     root: null,\n  //     rootMargin: '10px',\n  //     threshold: 0.1\n  //   }\n  //   overserver = new IntersectionObserver(handleIntersect, options)\n  //   observer.observe(boxElement);\n\n  //   function handleIntersect(entries, observer) {\n  //     entries.forEach((entry) => {\n  //       //DOM = entry.target으로 지정하면 해당 요소 관찰\n  //       if (entry.intersectionRatio > prevRatio) {\n  //         entry.target.style.backgroundColor = increasingColor.replace(\"ratio\", entry.intersectionRatio);\n  //       } else {\n  //         entry.target.style.backgroundColor = decreasingColor.replace(\"ratio\", entry.intersectionRatio);\n  //       }\n    \n  //       prevRatio = entry.intersectionRatio;\n  //     });\n  //   }\n\n  //   observerHandler = (entries, observer) => {\n  //     entries.forEach((entry) => {\n  //       console.log(this);\n\n  //       if (entry.isIntersecting) {\n  //         console.log(\"print\");\n  //         const image = entry.target;\n  //         const src = image.dataset.src; // img 태그의 data-lazy에 저장해둔 이미지 경로를 붙여준다.\n  //         image.setAttribute(\"src\", src);\n  //         image.removeAttribute(\"data-src\");\n  //         observer.unobserve(entry.target);\n  //       }\n  //     }, {\n  //       rootMargin: '1px 1px 1px 1px',\n  //       thresholds: [0.7],\n  //     });\n  //   }\n\n  // lazyLoadHandler= () => {\n  //     this.lazyImages = Array.prototype.slice.call(\n  //       // document.body.querySelectorAll(\".image\")\n  //     );\n\n  //     this.intersectionObserver = new IntersectionObserver(this.observerHandler.bind(this), this.options);\n\n  //     this.lazyImages.forEach((item) => this.intersectionObserver.observe(item));\n  //   }\n// ref={rootRef}\n  return (\n    <div className=\"container\">\n      {list.map((el, i) => {\n          return (\n            // <Card className=\"box\" key={i} ref={i == list.length - 1 && !payload.params.totalCount ? targetRef : null} ListData={list} item={el}/>\n            <Card className=\"box\" key={i} ListData={list} item={el}/>\n          );\n        })\n      }\n      <button type=\"button\" onClick={handlerNaxtBtn}>PUSH!</button>\n      <div ref={targetRef} className=\"spinner\">Loading...</div>\n      {/* {isLoading && <p>Loading...</p>} */}\n    </div>\n  );\n}\n\nexport default MainContainer;\n\n\n"]},"metadata":{},"sourceType":"module"}