{"ast":null,"code":"var _jsxFileName = \"/Users/we/dev/cp-dev/src/page/main/MainContainer.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport axios from 'axios';\nimport PAGECONST from './utils/Constants';\nimport Card from '../../components/molecules/layout/card/Card';\nimport UseIntersectionObserver from '../../components/organisms/UseIntersectionObserver';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction MainContainer({}) {\n  _s();\n\n  const [paging, setPaging] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [list, setList] = useState([]);\n  const [payload, setPayload] = useState({\n    params: {\n      page: 1,\n      pageCount: PAGECONST.count,\n      totalCount: 0\n    }\n  });\n  /* 타겟 엘리먼트 */\n\n  const rootRef = useRef(null);\n  const targetRef = useRef(null);\n\n  const getData = () => {\n    let key = '80CFeBE4MD6JmhEfClBx7zqo1eGvwTl5EZgKyMQc';\n    axios.get(\"http://52.78.173.151/boards\", {\n      \"x-api-key\": key,\n      params: {\n        page: payload.params.page,\n        count: payload.params.pageCount\n      }\n    }).then(response => {\n      if (response) {\n        const {\n          result,\n          data\n        } = response.data;\n\n        if (result.code === 1) {\n          setIsLoading(true);\n          const paging = response.data.paging;\n          const newList = response.data.data;\n          const updateList = list.concat(newList);\n          setList(updateList);\n          setPaging(paging);\n          setIsLoading(false);\n        }\n      }\n    }).catch(err => alert(\"글을 가져오는데 실패 했습니다.\"));\n  };\n\n  const handlerNaxtBtn = () => {\n    const {\n      page\n    } = payload.params;\n\n    if (Math.ceil(paging.totalCount / paging.count) > payload.params.page) {\n      setPayload({\n        params: { ...payload.params,\n          page: page + 1\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    getData();\n  }, [payload]);\n  useEffect(() => {}, [list, paging]);\n\n  function handleIntersect(entries, observer) {\n    entries.forEach(entry => {\n      if (entry.intersectionRatio > prevRatio) {\n        entry.target.style.backgroundColor = increasingColor.replace(\"ratio\", entry.intersectionRatio);\n      } else {\n        entry.target.style.backgroundColor = decreasingColor.replace(\"ratio\", entry.intersectionRatio);\n      }\n\n      prevRatio = entry.intersectionRatio;\n    });\n  }\n\n  function buildThresholdList() {\n    let thresholds = [];\n    let numSteps = 20;\n\n    for (let i = 1.0; i <= numSteps; i++) {\n      let ratio = i / numSteps;\n      thresholds.push(ratio);\n    }\n\n    thresholds.push(0);\n    return thresholds;\n  }\n\n  function createObserver() {\n    let observer;\n    let options = {\n      root: null,\n      rootMargin: \"0px\",\n      threshold: buildThresholdList()\n    };\n    observer = new IntersectionObserver(handleIntersect, options);\n    observer.observe(boxElement);\n  }\n\n  const numSteps = 20.0;\n  let boxElement;\n  let prevRatio = 0.0;\n  let increasingColor = \"rgba(40, 40, 190, ratio)\";\n  let decreasingColor = \"rgba(190, 40, 40, ratio)\"; // Set things up\n\n  window.addEventListener(\"load\", event => {\n    boxElement = document.querySelector(\"#card\");\n    createObserver();\n  }, false);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: rootRef,\n    children: [list.map((el, i) => {\n      return /*#__PURE__*/_jsxDEV(Card, {\n        id: \"card\",\n        className: \"box\",\n        ref: i == list.length - 1 && !payload.params.totalCount ? targetRef : null,\n        ListData: list,\n        item: el\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 15\n      }, this) // <Card id=\"card\" className=\"box\" key={i} ref={i == list.length - 1 && !payload.params.totalCount ? targetRef : null} ListData={list} item={el}/>\n      ;\n    }), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: handlerNaxtBtn,\n      children: \"PUSH!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 7\n  }, this);\n}\n\n_s(MainContainer, \"HjR8pfwHIX/fcmDAq52ZZau3MSA=\");\n\n_c = MainContainer;\nexport default MainContainer;\n\nvar _c;\n\n$RefreshReg$(_c, \"MainContainer\");","map":{"version":3,"sources":["/Users/we/dev/cp-dev/src/page/main/MainContainer.js"],"names":["React","useState","useEffect","useCallback","useRef","axios","PAGECONST","Card","UseIntersectionObserver","MainContainer","paging","setPaging","isLoading","setIsLoading","list","setList","payload","setPayload","params","page","pageCount","count","totalCount","rootRef","targetRef","getData","key","get","then","response","result","data","code","newList","updateList","concat","catch","err","alert","handlerNaxtBtn","Math","ceil","handleIntersect","entries","observer","forEach","entry","intersectionRatio","prevRatio","target","style","backgroundColor","increasingColor","replace","decreasingColor","buildThresholdList","thresholds","numSteps","i","ratio","push","createObserver","options","root","rootMargin","threshold","IntersectionObserver","observe","boxElement","window","addEventListener","event","document","querySelector","map","el","length"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useCallback, useRef} from 'react'\nimport axios from 'axios'\nimport PAGECONST from './utils/Constants';\nimport Card from '../../components/molecules/layout/card/Card'\nimport UseIntersectionObserver from '../../components/organisms/UseIntersectionObserver'\n\nfunction MainContainer({}) { \n    const [paging, setPaging] = useState({})\n    const [isLoading, setIsLoading] = useState(false)\n    const [list, setList] = useState([])\n    const [payload, setPayload] = useState({\n        params: {\n            page: 1,\n            pageCount: PAGECONST.count,\n            totalCount: 0\n        }\n    })\n    /* 타겟 엘리먼트 */\n    const rootRef = useRef(null);\n    const targetRef = useRef(null);\n\n    const getData = () => {\n      let key = '80CFeBE4MD6JmhEfClBx7zqo1eGvwTl5EZgKyMQc'\n      axios.get(\"http://52.78.173.151/boards\", {\n        \"x-api-key\": key,\n        params:{\n          page: payload.params.page,\n          count: payload.params.pageCount\n        }\n        })\n        .then( response => {\n         if(response){\n           const { result, data } = response.data\n           if(result.code === 1){\n              setIsLoading(true)\n              const paging = response.data.paging;\n              const newList = response.data.data;\n              const updateList = list.concat(newList);\n              setList(updateList);\n              setPaging(paging)\n              setIsLoading(false)\n           }\n         }\n        })\n        .catch(err => alert(\"글을 가져오는데 실패 했습니다.\"))\n    }\n\n    const handlerNaxtBtn = () =>{\n      const { page } = payload.params;\n      if(Math.ceil(paging.totalCount / paging.count) > payload.params.page){\n        setPayload({\n          params: {\n            ...payload.params,\n            page: page + 1,\n          }\n        })\n      }\n    }\n\n   \n\n    useEffect(() => {\n        getData();\n    },[payload])\n    useEffect(() =>{\n    },[list, paging])\n\n\n    function handleIntersect(entries, observer) {\n      entries.forEach((entry) => {\n        if (entry.intersectionRatio > prevRatio) {\n          entry.target.style.backgroundColor = increasingColor.replace(\"ratio\", entry.intersectionRatio);\n        } else {\n          entry.target.style.backgroundColor = decreasingColor.replace(\"ratio\", entry.intersectionRatio);\n        }\n    \n        prevRatio = entry.intersectionRatio;\n      });\n    }\n    function buildThresholdList() {\n      let thresholds = [];\n      let numSteps = 20;\n    \n      for (let i=1.0; i<=numSteps; i++) {\n        let ratio = i/numSteps;\n        thresholds.push(ratio);\n      }\n    \n      thresholds.push(0);\n      return thresholds;\n    }\n    function createObserver() {\n      let observer;\n    \n      let options = {\n        root: null,\n        rootMargin: \"0px\",\n        threshold: buildThresholdList()\n      };\n    \n      observer = new IntersectionObserver(handleIntersect, options);\n      observer.observe(boxElement);\n    }\n    const numSteps = 20.0;\n\n    let boxElement;\n    let prevRatio = 0.0;\n    let increasingColor = \"rgba(40, 40, 190, ratio)\";\n    let decreasingColor = \"rgba(190, 40, 40, ratio)\";\n\n    // Set things up\n    window.addEventListener(\"load\", (event) => {\n      boxElement = document.querySelector(\"#card\");\n\n      createObserver();\n    }, false);\n\t\n    return (\n      <div ref={rootRef}>\n        {list.map((el, i) => {\n            return (\n              <Card id=\"card\" className=\"box\" key={i} ref={i == list.length - 1 && !payload.params.totalCount ? targetRef : null} ListData={list} item={el}/> \n              // <Card id=\"card\" className=\"box\" key={i} ref={i == list.length - 1 && !payload.params.totalCount ? targetRef : null} ListData={list} item={el}/>\n            );\n          })\n        }\n        <button type=\"button\" onClick={handlerNaxtBtn}>PUSH!</button>\n        {isLoading && <p>Loading...</p>}\n      </div>\n    );\n  }\n\nexport default MainContainer;\n\n\n"]},"metadata":{},"sourceType":"module"}